<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Calend√°rio de Anota√ß√µes</title>
<style>
/* Estilos gerais */
body {
    font-family: Arial, sans-serif;
    margin: 20px;
    text-align: center;
}
h1 {
    margin-bottom: 20px;
}

/* Estilos do calend√°rio */
.calendar {
    margin: auto;
    border-collapse: collapse;
    width: 100%;
    max-width: 600px;
}
.calendar th, .calendar td {
    border: 1px solid #ccc;
    width: 14%;
    height: 80px;
    vertical-align: top;
    padding: 5px;
    position: relative;
}
.calendar th {
    background-color: #f0f0f0;
}
.calendar td {
    cursor: pointer;
}
.calendar td:hover {
    background-color: #f9f9f9;
}

/* √çcone de nota no dia */
.note-icon {
    position: absolute;
    top: 2px;
    right: 4px;
    font-size: 0.8em;
}

/* Estilo modal */
.modal {
    display: none; /* oculto por padr√£o */
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4); /* fundo semitransparente */
}
.modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 400px;
    text-align: left;
    position: relative;
}

/* Bot√µes */
button {
    padding: 8px 12px;
    margin: 5px;
    cursor: pointer;
}
button:hover {
    background-color: #ddd;
}

/* Fechar modal */
.close {
    color: #aaa;
    float: right;
    font-size: 20px;
    font-weight: bold;
}
.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
}
textarea {
    width: 100%;
    height: 60px;
    margin-top: 10px;
}
</style>
</head>
<body>
<h1>Calend√°rio de Anota√ß√µes</h1>

<!-- Navega√ß√£o de m√™s -->
<button id="prevMonthBtn">Anterior</button>
<button id="nextMonthBtn">Pr√≥ximo</button>
<span id="monthAndYear"></span>

<!-- Calend√°rio gerado dinamicamente -->
<table id="calendar" class="calendar">
    <!-- Cabe√ßalho dias da semana -->
    <thead>
        <tr>
            <th>Seg</th>
            <th>Ter</th>
            <th>Qua</th>
            <th>Qui</th>
            <th>Sex</th>
            <th>S√°b</th>
            <th>Dom</th>
        </tr>
    </thead>
    <tbody id="calendar-body">
        <!-- Dias do m√™s ser√£o inseridos aqui -->
    </tbody>
</table>

<!-- Modal para visualiza√ß√£o/adicionar notas -->
<div id="noteModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeModal">&times;</span>
    <h2 id="modalDateTitle">Notas do dia</h2>
    <ul id="notesList"></ul>
    <textarea id="newNoteInput" placeholder="Digite uma nova anota√ß√£o"></textarea>
    <button id="saveNoteBtn">Salvar Nota</button>
  </div>
</div>

<script>
/* ===== Inicializa√ß√£o do calend√°rio ===== */
// Array de meses em portugu√™s
const months = ["Janeiro", "Fevereiro", "Mar\u00e7o", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
let currentDate = new Date();
let currentMonth = currentDate.getMonth();
let currentYear = currentDate.getFullYear();

// Seleciona elementos do DOM
const calendarBody = document.getElementById("calendar-body");
const monthAndYear = document.getElementById("monthAndYear");
const prevMonthBtn = document.getElementById("prevMonthBtn");
const nextMonthBtn = document.getElementById("nextMonthBtn");

const noteModal = document.getElementById("noteModal");
const closeModal = document.getElementById("closeModal");
const modalDateTitle = document.getElementById("modalDateTitle");
const notesList = document.getElementById("notesList");
const newNoteInput = document.getElementById("newNoteInput");
const saveNoteBtn = document.getElementById("saveNoteBtn");

let selectedDateKey = ""; // guarda a data selecionada atual (formato YYYY-MM-DD)

/* Atualiza o calend√°rio exibido (m√™s e ano) e pinta os dias */
function showCalendar(month, year) {
    // Configura t√≠tulo do m√™s/ano
    monthAndYear.textContent = months[month] + " " + year;
    // Primeiro dia do m√™s (no JS domingo=0, ajustamos para segunda=1 ... domingo=7)
    let firstDay = new Date(year, month, 1).getDay();
    firstDay = (firstDay === 0) ? 7 : firstDay;
    
    // N√∫mero de dias no m√™s
    let daysInMonth = new Date(year, month + 1, 0).getDate();
    
    // Limpa c√©lulas antigas do calend√°rio
    calendarBody.innerHTML = "";
    
    let date = 1;
    // 6 linhas (para cobrir meses que iniciam no domingo ou t√™m 31 dias)
    for (let i = 0; i < 6; i++) {
        let row = document.createElement("tr");
        
        // 7 colunas para os dias da semana
        for (let j = 1; j <= 7; j++) {
            let cell = document.createElement("td");
            if (i === 0 && j < firstDay) {
                // Espa√ßos em branco antes do primeiro dia
                cell.innerHTML = "";
            } else if (date > daysInMonth) {
                // Espa√ßos em branco ap√≥s o √∫ltimo dia
                cell.innerHTML = "";
            } else {
                cell.innerHTML = date;
                let cellDate = year + "-" + String(month+1).padStart(2,"0") + "-" + String(date).padStart(2,"0");
                cell.setAttribute("data-date", cellDate);
                
                // Se houver notas salvas neste dia, adicionar √≠cone
                let notesForDay = localStorage.getItem("notes-" + cellDate);
                if (notesForDay) {
                    const noteIcon = document.createElement("span");
                    noteIcon.classList.add("note-icon");
                    noteIcon.textContent = "üìù"; // √≠cone de nota (emoji)
                    cell.appendChild(noteIcon);
                }
                
                // Ao clicar em um dia, abre o modal para visualizar/adicionar notas
                cell.addEventListener("click", function() {
                    openNoteModal(cellDate);
                });
                
                date++;
            }
            row.appendChild(cell);
        }
        
        calendarBody.appendChild(row);
    }
}

/* ===== Navega√ß√£o entre meses ===== */
prevMonthBtn.addEventListener("click", function() {
    currentYear = (currentMonth === 0) ? currentYear - 1 : currentYear;
    currentMonth = (currentMonth === 0) ? 11 : currentMonth - 1;
    showCalendar(currentMonth, currentYear);
});
nextMonthBtn.addEventListener("click", function() {
    currentYear = (currentMonth === 11) ? currentYear + 1 : currentYear;
    currentMonth = (currentMonth + 1) % 12;
    showCalendar(currentMonth, currentYear);
});

/* ===== Fun√ß√£o de abertura do modal para o dia selecionado ===== */
// Ao clicar em um dia, esta fun√ß√£o abre um modal com as notas desse dia
function openNoteModal(dateKey) {
    selectedDateKey = dateKey;
    const [y, m, d] = dateKey.split("-");
    modalDateTitle.textContent = "Notas de " + d + "/" + m + "/" + y;
    // Limpa a lista de notas exibidas
    notesList.innerHTML = "";
    newNoteInput.value = "";
    // Carrega notas do localStorage para a data
    let savedNotes = JSON.parse(localStorage.getItem("notes-" + dateKey)) || [];
    // Exibe cada nota existente na lista
    savedNotes.forEach(function(note) {
        let li = document.createElement("li");
        li.textContent = note;
        notesList.appendChild(li);
    });
    // Exibe o modal
    noteModal.style.display = "block";
}

/* ===== Fechar modal ===== */
closeModal.addEventListener("click", function() {
    noteModal.style.display = "none";
});
window.addEventListener("click", function(event) {
    if (event.target === noteModal) {
        noteModal.style.display = "none";
    }
});

/* ===== Salvar nova nota ===== */
    // Ao clicar em "Salvar Nota", esta fun√ß√£o salva a anota√ß√£o no localStorage e atualiza a lista
    saveNoteBtn.addEventListener("click", function() {
    const noteText = newNoteInput.value.trim();
    if (noteText !== "") {
        let notesKey = "notes-" + selectedDateKey;
        // Obt√©m notas atuais ou cria array vazio
        let notesArray = JSON.parse(localStorage.getItem(notesKey)) || [];
        // Adiciona nova nota ao array
        notesArray.push(noteText);
        // Salva de volta no localStorage
        localStorage.setItem(notesKey, JSON.stringify(notesArray));
        
        // Atualiza √≠cone no calend√°rio se foi a primeira nota
        const cells = document.querySelectorAll("td[data-date='" + selectedDateKey + "']");
        cells.forEach(function(cell) {
            if (!cell.querySelector(".note-icon")) {
                const noteIcon = document.createElement("span");
                noteIcon.classList.add("note-icon");
                noteIcon.textContent = "üìù";
                cell.appendChild(noteIcon);
            }
        });
        // Atualiza a lista no modal
        let li = document.createElement("li");
        li.textContent = noteText;
        notesList.appendChild(li);
        // Limpa o campo de input
        newNoteInput.value = "";
    }
});

/* ===== Inicializa mostrando o calend√°rio atual ===== */
showCalendar(currentMonth, currentYear);
</script>
</body>
</html>